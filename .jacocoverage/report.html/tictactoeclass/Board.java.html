<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>Board.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JaCoCoverage analysis of project &quot;TicTacToeClass&quot; (powered by JaCoCo from EclEmma)</a> &gt; <a href="index.source.html" class="el_package">tictactoeclass</a> &gt; <span class="el_source">Board.java</span></div><h1>Board.java</h1><pre class="source lang-java linenums">/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package tictactoeclass;


/**
 *   Board class &lt;br&gt;
 *    Defines enum for X and O, regardless of actual text symbols used &lt;br&gt;
 *    keeps track of boxes played &lt;br&gt;
 *    tracks player instance who plays next, but doesn't reference any player data &lt;br&gt;
 *    implements methods for resetting board, getting and setting box contents &lt;br&gt;
 *  &lt;P&gt;
 *  getBox (row, column)          returns contents of a box &lt;br&gt;
 *  setBox (row, column, symbol)  enters symbol into box &lt;br&gt;
 *           if box is not empty, assert, since assumes checked prior &lt;br&gt;
 *  resetBoard ()                 clears board &lt;br&gt;
 *  isWinner()                    checks if specified symbol has won &lt;br&gt;
 *    assumes calling routine only asks about a specific player
 *  isMoveValid()        checks if row and column within range and box empty &lt;br&gt;
 *  getWinningBoxes()    returns boxes with winning line for display &lt;br&gt;
 *  getNextToPlay()      returns Player whose turn it is &lt;br&gt;
 *  setNextToPlay(Player) sets next player to play
 * &lt;P&gt;
 * 4-October:  Clean-up
 *   added variables for gameOver and constants for board size
 *   isGameOver() - moved here (ie winner or 9 moves - ie draw)
 *   isDraw() - check if 9 moves (9 = a CONSTANT)
 *   starting moving towards parameterizing board size (e.g. RC_SIZE)
 *     but, win check and handling needs more thought and work
 *  Author: Lee
 * 
 */
<span class="pc bpc" id="L36" title="1 of 2 branches missed.">public class Board {</span>
    public static final int RC_SIZE = 3;  // Row Column size
    public static final int NUM_BOXES = RC_SIZE*RC_SIZE;  // full board count, for deciding draws
    
<span class="pc" id="L40">    public enum Symbols {X, O, b}    // b = blank (ie empty)</span>
<span class="fc" id="L41">    private Move winArray[] = new Move[RC_SIZE];   // winning boxes</span>
    
<span class="fc" id="L43">    private Symbols[][] boardArray = new Symbols [RC_SIZE][RC_SIZE];</span>
    
    // gameOver -&gt; true if winner
    // moveCounter counts valid moves to identify a draw (9 moves, no winner)
<span class="fc" id="L47">    private Boolean gameOver = false;</span>
<span class="fc" id="L48">    private int moveCounter = 0;</span>
    
    // Player with next move
<span class="fc" id="L51">    private Player nextToPlay = null;</span>
    
    // Save File instance pointer
    // leave saveTestFile in for now (test only), ToDo delete
<span class="fc" id="L55">    private FileSave saveFile = new FileSave();</span>
<span class="fc" id="L56">    private FileSave saveTestFile = new FileSave(&quot;eenyMeenyMineyMoe.txt&quot;);</span>
    
<span class="fc" id="L58">    Board () {</span>
<span class="fc" id="L59">        System.out.println(&quot;Board constructor&quot;);</span>
<span class="fc" id="L60">        this.resetBoard();</span>
<span class="fc" id="L61">    }</span>
    
    // getBox (row, column)          returns contents of a box
    public Symbols getBox(int row, int column) {
        // validate row &amp; column
<span class="fc" id="L66">        return(boardArray[row][column]);</span>
    }
    
    // setBox (tow, column, symbol)  enters symbol into box
    // Assumes: box is empty (see isMoveValid, assert if not
    
    public void setBox(int row, int column, Symbols symbol) {
        // validate row &amp; column
<span class="pc bpc" id="L74" title="2 of 4 branches missed.">        assert (boardArray[row][column] == Symbols.b):</span>
            &quot;setBox: box NOT empty&quot; + &quot;\trow: &quot; + row + &quot;\tcol: &quot; + column;
        // if no assert, valid move
<span class="fc" id="L77">        boardArray[row][column] = symbol;</span>
<span class="fc" id="L78">        moveCounter++;</span>
<span class="fc" id="L79">    }</span>
    
    // Overload setBox to accept move isntance (ie setBox(Move playerMove)
    //   calls setBox() with row, column and player symbol
    public void setBox(Move playerMove) {
<span class="fc" id="L84">        setBox(playerMove.getRow(), playerMove.getColumn(),</span>
<span class="fc" id="L85">                playerMove.getSymbol());</span>
<span class="fc" id="L86">    }</span>
    
    // resetBoard ()                 clears board
    public void resetBoard(){
<span class="fc bfc" id="L90" title="All 2 branches covered.">        for (int row = 0; row &lt; RC_SIZE; row++){</span>
<span class="fc bfc" id="L91" title="All 2 branches covered.">            for (int column = 0; column &lt; RC_SIZE; column++) {</span>
<span class="fc" id="L92">                  boardArray[row][column] = Symbols.b;</span>
            }
        }
<span class="fc" id="L95">        gameOver = false;</span>
<span class="fc" id="L96">        moveCounter = 0;</span>
<span class="fc" id="L97">    }</span>
    
    /**
     * isGameOver tracks if a winner OR draw occurred
     *   could ignore the draw (all boxes filled), so no valid moves
     *   but for now - check for move
     * @return true = game over
     */
    public Boolean isGameOver() {
<span class="pc bpc" id="L106" title="1 of 4 branches missed.">        if (isDraw() || (gameOver == true))</span>
<span class="fc" id="L107">            return true;</span>
        else
<span class="fc" id="L109">            return false;</span>
    }
    
    /**
     * isDraw
     * @return true if draw
     *   Note: gameOver variable tracks if a win (not a draw, so should rename)
     *   draw = all boxes filled and gameOver = false
     *   probably only need == NUM_BOXES, but just in case .....
     */
    public Boolean isDraw() {
<span class="pc bpc" id="L120" title="3 of 4 branches missed.">        if ((moveCounter &gt;= NUM_BOXES) &amp;&amp; (gameOver == false))</span>
<span class="nc" id="L121">            return true;</span>
        else
<span class="fc" id="L123">            return false;</span>
    }
    
    /**
     * isWinner() checks rows, columns and diag for 3 in a row
     * 
     * @param symbol - player symbol being checked if achieved 3 in a row
     * 
     * If player won
     *   winArray[] updated with winning cells (each cell is a Move structure)
     * @return true if player won, false if not
     * 
     * ToDo: refactor with more efficient checks and/or remove duplicate code
     * ToDo: remove hardcoding of array size (winArray[])
     */
    public Boolean isWinner(Symbols symbol) {
        int row, col;
        
        // gameOver is stateful, once set, true until game reset
        // symbolWon returns if the specified player has won (or hasn't won)
<span class="fc" id="L143">        Boolean symbolWon = false;</span>
        // check row winner
<span class="fc bfc" id="L145" title="All 2 branches covered.">        for (row = 0; row &lt; RC_SIZE; row++) {</span>
<span class="fc bfc" id="L146" title="All 2 branches covered.">            for (col = 0; col &lt; RC_SIZE; col++) {</span>
<span class="fc bfc" id="L147" title="All 2 branches covered.">                if (boardArray[row][col] != symbol) {</span>
<span class="fc" id="L148">                    break;</span>
                }
            }
<span class="fc bfc" id="L151" title="All 2 branches covered.">            if (col == RC_SIZE) {  // means row winner</span>
<span class="fc" id="L152">                winArray[0] = new Move(row, 0, symbol);</span>
<span class="fc" id="L153">                winArray[1] = new Move(row, 1, symbol);</span>
<span class="fc" id="L154">                winArray[2] = new Move(row, 2, symbol);</span>
<span class="fc" id="L155">                gameOver = true;</span>
<span class="fc" id="L156">                symbolWon = true;</span>
            }
        }
        // check column winner
<span class="fc bfc" id="L160" title="All 2 branches covered.">        for (col = 0; col &lt; RC_SIZE; col++) {</span>
<span class="pc bpc" id="L161" title="1 of 2 branches missed.">            for (row = 0; row &lt; RC_SIZE; row++) {</span>
<span class="fc bfc" id="L162" title="All 2 branches covered.">                if (boardArray[row][col] != symbol) {</span>
<span class="fc" id="L163">                    break;</span>
                }
            }
<span class="pc bpc" id="L166" title="1 of 2 branches missed.">            if (row == RC_SIZE) {  // column winner</span>
<span class="nc" id="L167">                winArray[0] = new Move(0, col, symbol);</span>
<span class="nc" id="L168">                winArray[1] = new Move(1, col, symbol);</span>
<span class="nc" id="L169">                winArray[2] = new Move(2, col, symbol);</span>
<span class="nc" id="L170">                gameOver = true;  // column winner</span>
<span class="nc" id="L171">                symbolWon = true;</span>
            }
        }
<span class="fc bfc" id="L174" title="All 6 branches covered.">        if ((boardArray[0][0] == symbol)  &amp;&amp;</span>
                (boardArray[1][1] == symbol) &amp;&amp;
                (boardArray[2][2] == symbol)) {
            // Diagonal winner
<span class="fc" id="L178">            winArray[0] = new Move(0, 0, symbol);</span>
<span class="fc" id="L179">            winArray[1] = new Move(1, 1, symbol);</span>
<span class="fc" id="L180">            winArray[2] = new Move(2, 2, symbol);</span>
<span class="fc" id="L181">            gameOver = true;  // back diag winner</span>
<span class="fc" id="L182">            symbolWon = true;</span>
        }
<span class="pc bpc" id="L184" title="1 of 6 branches missed.">        if ((boardArray[0][2] == symbol)  &amp;&amp;</span>
                (boardArray[1][1] == symbol) &amp;&amp;
                (boardArray[2][0] == symbol)) {
            // other diagonal winner
<span class="fc" id="L188">            winArray[0] = new Move(0, 2, symbol);</span>
<span class="fc" id="L189">            winArray[1] = new Move(1, 1, symbol);</span>
<span class="fc" id="L190">            winArray[2] = new Move(2, 0, symbol);</span>
<span class="fc" id="L191">            gameOver = true;  // forward diag winner</span>
<span class="fc" id="L192">            symbolWon = true;</span>
        }
<span class="fc" id="L194">        System.out.println(this);  // print instance info to console</span>
<span class="fc" id="L195">        return symbolWon;   // specified player won/hasn't won</span>
    }
    
    /**
     * isMoveValid() 
     *   checks if row and columns in range of gridsize (e.g. 0-2)
     *   checks if selected cell is empty
     * @param move - row and column to be validated
     * @return - true if move valid, false otherwise
     */
    public Boolean isMoveValid(Move move) {
        // valid row &amp; column
<span class="fc" id="L207">        int row = move.getRow();</span>
<span class="fc" id="L208">        int column = move.getColumn();</span>
        //   since start at 0, array index max is size minus one
<span class="pc bpc" id="L210" title="2 of 4 branches missed.">        if ((row &lt; 0) || (row &gt; RC_SIZE-1)) {</span>
<span class="nc" id="L211">            return false;</span>
        }
<span class="pc bpc" id="L213" title="2 of 4 branches missed.">        else if ((column &lt; 0) || (column &gt; RC_SIZE-1)) {</span>
<span class="nc" id="L214">            return false;</span>
        }
        // check if selected box is blank
<span class="pc bpc" id="L217" title="1 of 2 branches missed.">        if (boardArray[row][column] != Symbols.b) {</span>
<span class="nc" id="L218">            return false;</span>
        }
<span class="fc" id="L220">        return true;</span>
    }
    
    /**
     * 
     * @return  array[RC_SIZE] of winning boxes each of type Move
     * Notes: &lt;br&gt;
     *   Requires isWinner() to be called prior configure winning cells
     *   ToDo: Clear winArray in resetBoard, currently not cleared
     */
    public Move[] getWinningBoxes() {
<span class="fc" id="L231">        saveFile.writeToSaveFile(&quot;Game Over&quot;);</span>
<span class="fc" id="L232">        return winArray;</span>
    }
    
    /**
     * setNextToPlay() - set which player plays next 
     * @param player - will have next turn
     */
    public void setNextToPlay(Player player) {
<span class="fc" id="L240">        nextToPlay = player;</span>
<span class="fc" id="L241">    }</span>
    
    /**
     * getNextToPlay()
     * @return player whose turn it is
     */
    public Player getNextToPlay() {
<span class="pc bpc" id="L248" title="2 of 4 branches missed.">        assert nextToPlay != null: &quot;nextToPlay is null, need to set first&quot;;</span>
<span class="fc" id="L249">        return (nextToPlay);</span>
    }
    
    public String toString() {
    // private Move winArray[] = new Move[3];
    // private Symbols[][] boardArray = new Symbols [3][3];
    // private Boolean gameOver = false;
    // private int moveCounter = 0;
<span class="fc" id="L257">        String returnString = &quot;gameOver: &quot; + gameOver;</span>
<span class="fc" id="L258">        returnString += &quot;\tmoveCounter: &quot; + moveCounter;</span>
<span class="pc bpc" id="L259" title="1 of 2 branches missed.">        if (nextToPlay != null)</span>
<span class="fc" id="L260">            returnString += &quot;\tnextToPlay: &quot; + nextToPlay.getPlayerName();</span>
    // ToDo array printout not quite right yet
<span class="fc" id="L262">        returnString += &quot;\nboardArray: &quot; + boardArray;</span>
<span class="fc" id="L263">        returnString += &quot;\nwinArraay: &quot; + winArray;</span>
<span class="fc" id="L264">        returnString += &quot;\n&quot;;</span>
<span class="fc" id="L265">        return returnString;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.6.201602180812</span></div></body></html>